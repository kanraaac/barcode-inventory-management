# 임플란트 재고관리 시스템 PRD (v1.0)

## 1. 프로젝트 목적
- 치과 임플란트 재료의 입고/출고/재고관리를 바코드 스캔 기반으로 자동화하여, 실시간 재고 파악, 이력 추적, 오류 없는 입출고 처리를 실현한다.
- 제조사별 바코드 규격을 지원하며, 제품모델·제조일자·유효기간만 일치하면 입출고가 가능하도록 유연하게 설계한다.

## 2. 주요 요구사항 및 기능 정의
### 1) 바코드 입력 및 자동 이동
- A열(특히 A1 셀)에 바코드 스캔 시, 자동엔터 기능으로 입력 즉시 아래 셀로 이동하여 연속 입력이 가능해야 한다.
- 한/영 입력은 영어로 고정(사용자 안내문구 제공).

### 2) 바코드 정보 자동 추출 및 입력
- 바코드 예시: 010880004945285110221118P0400411221118173011159111115112-0027KR920395
- 자동 추출 항목: 제품모델(C열), 제조일자(F열), 유효기간(G열), 제작사(E열)
- 제조사별 바코드 규격 확장성: 디오, 오스템, 메가젠 등 제조사별 바코드 규격 지원

### 3) 입고/출고 처리 및 정보 연동
- 입고입력 시트: 바코드정보 시트에서 제품모델+유효기간+제조사만 일치하면 입고 가능, '현재고 정보' 시트에 오늘 날짜로 입고내역 자동 추가
- 출고입력 시트: 동일하게 제품모델+유효기간+제조사만 일치하면 출고 가능, '출고 이력' 시트에 출고내역 자동 추가
- 누적 재고/이력 자동 연동: '현재고 정보', '출고 이력', '입/출고 기록' 시트가 자동으로 연동되어 실시간 집계, 제품모델별 총재고 수량을 각 시트에서 한눈에 확인 가능

### 4) 예외 및 오류 처리
- 바코드 정보가 없거나, 매칭 실패 시 사용자에게 명확한 안내 메시지 제공
- 입력 오류, 중복, 미등록 바코드 등 예외 상황에 대한 안내 및 처리

## 3. 시트 구조 및 주요 컬럼
| 시트명         | 주요 컬럼(예시)                                                                                  | 설명                                   |
| -------------- | ----------------------------------------------------------------------------------------------- | -------------------------------------- |
| 바코드 정보    | 바코드번호, 제품명, 사이즈, 맞는사이즈, 제작사, 제조일자, 유효기간 등                            | 바코드별 상세정보 DB                   |
| 입고입력       | 바코드번호(A열), 처리결과(B열)                                                                  | 바코드 스캔 후 입고 처리               |
| 출고입력       | 바코드번호(A열), 처리결과(B열)                                                                  | 바코드 스캔 후 출고 처리               |
| 현재고 정보    | 입고날짜, 바코드번호, 제품명, 사이즈, 맞는사이즈, 제작사, 제조일자, 유효기간, 재고수량 등        | 실시간 재고 현황                       |
| 출고 이력      | 출고날짜, 바코드번호, 제품명, 사이즈, 맞는사이즈, 제작사, 제조일자, 유효기간 등                  | 출고 이력                              |
| 입/출고 기록   | 입고날짜, 출고날짜, 바코드번호, 제품명, 사이즈, 맞는사이즈, 제작사, 제조일자, 유효기간 등        | 전체 입출고 이력                       |

## 4. 액션스크립트(구글 앱스 스크립트) 설계 방향
- onEdit 트리거: 바코드 입력 시 자동 정보 추출 및 입력
- 입고/출고 처리 함수: 버튼 클릭 시 바코드정보 시트와 매칭, 입고/출고 처리 및 이력 기록
- 제품모델-사이즈 매핑: 내장 테이블 또는 별도 시트로 관리
- 예외처리 및 안내: 한글 메시지로 명확하게 안내

## 5. 적용 및 사용 방법
1. 구글시트에서 [확장 프로그램] → [Apps Script]로 이동
2. 제공되는 스크립트 복사 후 붙여넣기
3. 각 시트명, 컬럼명, 버튼명 등 실제 시트와 일치하도록 코드 내 변수 수정
4. '입고처리', '출고처리' 버튼은 시트에서 [삽입] → [그림] → [이미지로 버튼 추가] 후, 이미지 선택 → 우클릭 → [스크립트 할당]에서 함수명 지정
5. 저장 후 시트에서 직접 테스트

## 6. 확장 및 유지보수
- 제조사별 바코드 규격 추가: barcode_parser.gs, model_size_db.gs만 수정하면 확장 가능
- 시트 구조 변경: scripts 내 변수만 수정하면 적용 가능
- 예외처리/안내 메시지: error_handler.gs에서 한글로 관리
